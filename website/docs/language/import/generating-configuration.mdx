---
page_title: Import - Generating Configuration
description: >-
  Generate configuration and manage existing resources with Terraform using configuration-driven import.
---

# Generating Configuration

~> **Experimental:** Configuration generation is available in Terraform v1.5 as an experimental feature. Later minor versions may contain changes to the formatting of generated configuration and behavior of the `terraform plan` command using the `-generate-config-out` flag.

Terraform can generate HCL for resources that do not already exist in your configuration. Terraform produces HCL to act as a template that contains Terraform's best guess at the appropriate value for each resource argument. 

Starting with Terraform's generated HCL, we recommend iterating to find your ideal configuration by removing some attributes, adjusting the value of others, and rearranging `resource` blocks into files and modules as appropriate.

To generate configuration, use `terraform plan` with the `-generate-config-out` flag and supply a new file path. Do not supply a path to an existing file or Terraform will throw an error.

```shell
$ terraform plan -generate-config-out=generated_resources.tf
```

If any resources targeted by an [`import` block](/terraform/language/import/index) do not exist in your configuration, Terraform generates and writes configuration for those resources in `generated_resources.tf`.

## Workflow

The workflow for generating configuration is similar to the [`import` block workflow](/terraform/language/import/index#planning-and-applying-an-import), with the extra step of generating configuration during the planning stage. You can then review and modify the generated configuration before applying. 

### 1. Add the `import` Block

Add an `import` block to your configuration. The `import` block can be in a separate file (e.g. `import.tf`), or in an existing configuration file.

The `to` argument is the address of the new generated resource. If there is already a resource in configuration at this address, Terraform will attempt to import the resource there instead, and not generate configuration.

The `id` argument is the resource's import ID. Please see the provider resource documentation for how to find the import ID.

If you do not already have any other resources for this provider in your configuration, you must add a `provider` block so Terraform knows which provider to use when generating configuration. Terraform will display an error if it cannot determine the correct provider to use when generating configuration.

```hcl
provider "aws" {
  region = "eu-west-1"
}

import {
  to = aws_iot_thing.bar
  id = "foo"
}
```

### 2. Plan and Generate Configuration

You can instruct Terraform to generate configuration by running `terraform plan` with the `-generate-config-out=` flag and a new file path. Terraform displays its plan for importing your resource and the file where Terraform generated configuration based on this plan. 

```shell
$ terraform plan -generate-config-out=generated.tf

aws_iot_thing.bar: Preparing import... [id=foo]
aws_iot_thing.bar: Refreshing state... [id=foo]

Terraform will perform the following actions:

  # aws_iot_thing.bar will be imported
  # (config will be generated)
    resource "aws_iot_thing" "bar" {
        arn               = "arn:aws:iot:eu-west-1:1234567890:thing/foo"
        attributes        = {}
        default_client_id = "foo"
        id                = "foo"
        name              = "foo"
        version           = 1
    }

Plan: 1 to import, 0 to add, 0 to change, 0 to destroy.

╷
│ Warning: Config generation is experimental
│ 
│ Generating configuration during import is currently experimental, and the generated configuration format may change in future versions.
╵

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Terraform has generated configuration and written it to generated.tf. Please review the configuration and edit it as necessary before adding it to version control.
```

### 3. Review Generated Configuration

In our example, we specified that Terraform should generate configuration in a file named `generated.tf`. The below code demonstrates what the `generated.tf` file might look like. 

```hcl
resource aws_iot_thing "bar" {
  name = "foo"
}
```

You can review the code Terraform generated and add or remove resource arguments, variables, and references to other resources as needed for your configuration. 

### 4. Apply
Running `terraform apply` imports your infrastructure.

```shell
$ terraform apply

aws_iot_thing.bar: Preparing import... [id=foo]
aws_iot_thing.bar: Refreshing state... [id=foo]

Terraform will perform the following actions:

  # aws_iot_thing.bar will be imported
    resource "aws_iot_thing" "bar" {
        arn               = "arn:aws:iot:eu-west-1:1234567890:thing/foo"
        attributes        = {}
        default_client_id = "foo"
        id                = "foo"
        name              = "foo"
        version           = 1
    }

Plan: 1 to import, 0 to add, 0 to change, 0 to destroy.
aws_iot_thing.bar: Importing... [id=foo]
aws_iot_thing.bar: Import complete [id=foo]

Apply complete! Resources: 1 imported, 0 added, 0 changed, 0 destroyed.

```

Ensure you add your generated code alongside your Terraform code to your version control system.

## Limitations

### Conflicting Resource Arguments

Terraform generates configuration for importable resources during a plan by requesting values for resource attributes from the provider. For certain resources with complex schemas, it may not be possible for Terraform to construct a valid configuration from these values.

Terraform will display an error like the one below if it does not receive values for resource attributes while generating configuration.

```shell
$ terraform plan -generate-config-out=generated.tf
╷
│ Error: Conflicting configuration arguments
│ 
│   with aws_instance.ubuntu,
│   on g.tf line 20, in resource "aws_instance" "ubuntu":
│   20:   ipv6_address_count                   = 0
│ 
│ "ipv6_address_count": conflicts with ipv6_addresses
╵
```

In the example above, Terraform still generates configuration and writes it to `generated.tf`. This error stems from a conflict between the `ipv6_address_count` and `ipv6_addresses` arguments. You could fix the error by removing one of these two arguments, then running `terraform plan` again to check that there are no further issues.
