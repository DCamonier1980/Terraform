---
page_title: Import - Generating Configuration
description: >-
  Generate configuration and manage existing resources with Terraform using configuration-driven import.
---

# Generating Configuration

~> **Experimental:** Configuration generation is available in Terraform v1.5 as an experimental feature. Later minor versions may contain changes to the formatting of generated configuration and behavior of the `terraform plan` command using the `-generate-config-out` flag.

Terraform can generate HCL for resources that do not already exist in your configuration. Terraform produces HCL to act as a template that contains Terraform's best guess at the appropriate value for each resource argument. 

Starting with Terraform's generated HCL, we recommend iterating to find your ideal configuration by removing some attributes, adjusting the value of others, and rearranging `resource` blocks into files and modules as appropriate.

To generate configuration, use `terraform plan` with the `-generate-config-out` flag and supply a new file path. Do not supply a path to an existing file, this command creates a new one. 

```
terraform plan -generate-config-out=generated_resources.tf
```

If any resources targeted by an [`import` block](/terraform/language/import/index) do not exist in your configuration, Terraform generates and writes configuration for those resources in `generated_resources.tf`.

## Workflow

The workflow for generating configuration is similar to the [`import` block workflow](/terraform/language/import/index#planning-and-applying-an-import), with the extra step of generating configuration during the planning stage.  You can then review and tweak the file Terraform generates before applying your configuration. 

### 1. Add the `import` Block

```hcl
provider "aws" {
  region = "eu-west-1"
}

import {
  to = aws_iot_thing.bar
  id = "foo"
}
```

### 2. Plan and Generate Configuration
Next, you will run the `terraform plan` command with the `-generate-config-out=` flag and a file path.

```
$ terraform plan -generate-config-out=generated.tf

aws_iot_thing.bar: Preparing import... [id=foo]
aws_iot_thing.bar: Refreshing state... [id=foo]

Terraform will perform the following actions:

  # aws_iot_thing.bar will be imported
    resource "aws_iot_thing" "bar" {
        arn               = "arn:aws:iot:eu-west-1:1234567890:thing/foo"
        attributes        = {}
        default_client_id = "foo"
        id                = "foo"
        name              = "foo"
        version           = 1
    }

Plan: 1 to import, 0 to add, 0 to change, 0 to destroy.
```

### 3. Review Generated Configuration

In our example, we specified that Terraform should generate configuration in a file named `generated.tf`. The below code demonstrates what the `generated.tf` file might look like. 

```hcl
resource aws_iot_thing "bar" {
  name = "foo"
}
```

You can review the code Terraform generated and add or remove resource arguments, variables, and references to other resources as needed for your configuration. 

### 4. Apply
Running `terraform apply` create and provisions your infrastructure. Ensure you add your generated code alongside your Terraform code to your version control system.

```
$ terraform apply

aws_iot_thing.bar: Preparing import... [id=foo]
aws_iot_thing.bar: Refreshing state... [id=foo]

Terraform will perform the following actions:

  # aws_iot_thing.bar will be imported
    resource "aws_iot_thing" "bar" {
        arn               = "arn:aws:iot:eu-west-1:1234567890:thing/foo"
        attributes        = {}
        default_client_id = "foo"
        id                = "foo"
        name              = "foo"
        version           = 1
    }

Plan: 1 to import, 0 to add, 0 to change, 0 to destroy.
aws_iot_thing.bar: Importing... [id=foo]
aws_iot_thing.bar: Import complete [id=foo]

Apply complete! Resources: 1 imported, 0 added, 0 changed, 0 destroyed.

```

Make sure that your generated code, along with your other Terraform code, is added to your version control system.

## Limitations

Terraform generates configuration for importable resources during a plan by requesting values for resource attributes from the provider. For certain resources with complex schemas, it may not be possible for Terraform to construct a valid configuration from these values.

Terraform will throw an error like the one below if it does not receive values for resource attributes while generating configuration.

```
$ terraform plan -generate-config-out=generated.tf
╷
│ Error: Conflicting configuration arguments
│ 
│   with aws_instance.ubuntu,
│   on g.tf line 20, in resource "aws_instance" "ubuntu":
│   20:   ipv6_address_count                   = 0
│ 
│ "ipv6_address_count": conflicts with ipv6_addresses
╵
```

In the example above, Terraform still generates configuration and writes it to `generated.tf`. This error stems from a conflict between the `ipv6_address_count` and `ipv6_addresses` arguments. You could fix the error by removing one of these two arguments.
